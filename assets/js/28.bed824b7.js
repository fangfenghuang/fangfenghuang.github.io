(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{354:function(a,s,t){"use strict";t.r(s);var n=t(0),e=Object(n.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("p",[a._v("https://github.com/openebs/lvm-localpv")]),a._v(" "),s("h2",{attrs:{id:"pv"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#pv"}},[a._v("#")]),a._v(" pv")]),a._v(" "),s("h3",{attrs:{id:"创建pv"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建pv"}},[a._v("#")]),a._v(" 创建pv")]),a._v(" "),s("p",[a._v("pvname=${disk}1")]),a._v(" "),s("p",[a._v("sgdisk -n 1:2048 ${disk}\npvcreate ${pvname}\npvdisplay ${pvname}")]),a._v(" "),s("h3",{attrs:{id:"创建vg"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建vg"}},[a._v("#")]),a._v(" 创建vg")]),a._v(" "),s("p",[a._v("vgcreate ${vgname} ${pvname}\nvgextend ${vgname} ${pvname}\npvdisplay ${pvname} | grep ${vgname}")]),a._v(" "),s("h2",{attrs:{id:"deploy"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#deploy"}},[a._v("#")]),a._v(" deploy")]),a._v(" "),s("p",[a._v("$ kubectl apply -f https://openebs.github.io/charts/lvm-operator.yaml")]),a._v(" "),s("h1",{attrs:{id:"应用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#应用"}},[a._v("#")]),a._v(" 应用")]),a._v(" "),s("div",{staticClass:"language-yaml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("apiVersion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" storage.k8s.io/v1\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("kind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" StorageClass\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" openebs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("lvmpv\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("allowVolumeExpansion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[a._v("true")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("parameters")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("storage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"lvm"')]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("volgroup")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"lvmvg"')]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("provisioner")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" local.csi.openebs.io\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("allowedTopologies")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("matchLabelExpressions")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("key")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" kubernetes.io/hostname\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("values")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" lvmpv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("node1\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" lvmpv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("node2\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br")])]),s("p",[a._v("volgroup：选择vg\nallowedTopologies: 选择节点")]),a._v(" "),s("h1",{attrs:{id:"disk回收"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#disk回收"}},[a._v("#")]),a._v(" disk回收")]),a._v(" "),s("p",[a._v("pvname=${disk}1")]),a._v(" "),s("p",[a._v("vgremove ${vgname} 或 vgreduce ${vgname} ${pvname}")]),a._v(" "),s("p",[a._v("pvremove ${pvname}")]),a._v(" "),s("p",[a._v("pvdisplay ${pvname}")]),a._v(" "),s("p",[a._v("sgdisk --zap-all --clear --mbrtogpt ${disk}")])])}),[],!1,null,null,null);s.default=e.exports}}]);